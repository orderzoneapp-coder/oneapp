<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- [추가] 브라우저 자동 번역 제안 차단 -->
    <meta name="google" content="notranslate">
    <title>오더즈 - 식자재 주문의 새로운 기준</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>

    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f3f4f6; }
        :root { 
            --brand-primary: #14682A; 
            --brand-hover: #0f5220; 
            --box-bg: #f8fafc; 
            --required-color: #f472b6;
            --kakao-bg: #FEE500;
        }
        /* [Layout] */
        .check-container { 
            max-width: 480px; margin: 0 auto; background-color: #ffffff; 
            min-height: 100vh;
            display: flex; flex-direction: column;
            padding: 0 24px; 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); position: relative; 
        }
        
        .input-focus:focus { outline: none; border-color: var(--brand-primary); box-shadow: 0 0 0 1px var(--brand-primary); background-color: #fff; }
        .input-box-style { background-color: var(--box-bg); }
        .placeholder-required::placeholder { color: #9ca3af; font-weight: 400; }

        .btn-brand { background-color: var(--brand-primary); color: white; }
        .btn-kakao { background-color: var(--kakao-bg); color: #191919; }
        
        /* Animations */
        .fade-in { animation: fadeIn 0.6s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .hidden-step { display: none; opacity: 0; }
        .show-step { display: block; animation: fadeInUp 0.5s ease-out forwards; }

        .custom-label { font-size: 14px; font-weight: 700; color: #1f2937; margin-bottom: 6px; display: block; }
        .required-dot { color: #ef4444; margin-left: 2px; }

        /* App Launch Simulation Spinner */
        .kakao-spinner {
            width: 40px; height: 40px; border-radius: 50%;
            border: 4px solid #FEE500; border-top-color: #3c1e1e;
            animation: spin 1s linear infinite; margin: 0 auto 16px auto;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Custom Checkbox Color */
        input[type="checkbox"].accent-brand {
            accent-color: var(--brand-primary);
        }
    </style>
 head>
<body>

    <div class="check-container pb-20">
        
        <!-- [Header] 버전 정보 -->
        <div class="absolute top-6 right-6 z-10 flex items-center gap-2">
            <span class="text-[10px] text-gray-400 font-mono tracking-tighter">v3.3 (Marketing Consent Added)</span>
        </div>

        <!-- [상단] 브랜딩 영역 -->
        <div class="pt-16 pb-8 text-center fade-in">
            <h1 class="text-base font-bold text-[#14682A] tracking-tight cursor-pointer mb-2 notranslate" translate="no" onclick="location.reload()">ORDERZ</h1>
            <h2 class="text-3xl font-extrabold text-gray-900 mb-2 leading-tight">오더즈가 기억합니다</h2>
            <p class="text-lg text-gray-600 font-medium">내 방식대로, 쓸수록 손에 익는 플랫폼</p>
        </div>

        <form id="matchingForm" onsubmit="return false;" class="flex-1 flex flex-col">
            
            <!-- 1. 주소 입력 -->
            <div id="step-address" class="mb-10 fade-in" style="animation-delay: 0.2s;">
                <h3 class="text-lg font-bold text-gray-800 mb-1">주소 기반 상품 매칭</h3>
                <p class="text-sm text-[#14682A] mb-5">사장님 지역의 특가 상품을 지금 확인해보세요.</p>
                
                <label class="custom-label">가게 주소 (배송지) <span class="required-dot">*</span></label>
                <div class="flex gap-2 mb-2">
                    <input type="text" id="mb_addr1" 
                        class="flex-1 px-4 py-3.5 border border-gray-200 rounded-lg input-box-style text-gray-800 text-sm input-focus cursor-pointer placeholder-required"
                        placeholder="입력창 클릭 시 테스트 주소 자동 입력" readonly onclick="fillTestAddress()">
                    <button type="button" onclick="openDaumPostcode()" 
                        class="px-5 py-3.5 btn-brand text-sm font-bold rounded-lg transition whitespace-nowrap shadow-sm">
                        검색
                    </button>
                </div>
            </div>

            <!-- 2. 상세 정보 및 인증 -->
            <div id="step-auth" class="hidden-step">
                
                <!-- 상호명 -->
                <div class="mb-8">
                    <label class="custom-label" for="mb_company">상호명 <span class="required-dot">*</span></label>
                    <input type="text" id="mb_company" 
                        class="w-full px-4 py-3.5 border border-gray-200 rounded-lg input-box-style input-focus transition-colors text-sm placeholder-required"
                        placeholder="가게 상호명을 입력하세요">
                </div>

                <!-- 인증 영역 -->
                <div class="bg-gray-50 rounded-2xl p-5 border border-gray-100 transition-all duration-500">
                    
                    <!-- [Fast Track] 카카오 인증 -->
                    <button type="button" id="btn-kakao-main" onclick="handleKakaoSync()"
                        class="w-full h-14 btn-kakao rounded-lg font-bold text-[15px] flex items-center justify-center gap-2 shadow-sm transform active:scale-[0.98] transition">
                        <i class="fas fa-comment text-lg"></i>
                        카카오로 바로 보러가기
                    </button>

                    <!-- [Recovery Track] 카카오 버튼 터치 후 돌아왔을 때만 노출 -->
                    <div id="recovery-area" class="hidden-step overflow-hidden">
                        <div class="pt-6 border-t border-gray-200 mt-6">
                            <p class="text-center text-sm font-bold text-[#14682A] mb-4">카카오 로그인이 어려우신가요?</p>
                            
                            <div class="flex flex-col gap-3">
                                <input type="tel" id="mb_phone" 
                                    class="w-full px-4 py-3.5 border border-gray-200 rounded-lg input-box-style input-focus transition-colors text-sm placeholder-required"
                                    placeholder="휴대폰 번호를 입력하세요" oninput="autoHyphen(this);">
                                
                                <button type="button" onclick="submitWithPhone()"
                                    class="w-full py-4 btn-brand rounded-lg font-bold text-[15px] shadow-sm transition transform active:scale-[0.98]">
                                    특가 상품 보러 가기
                                </button>

                                <!-- [정보 동의 영역] -->
                                <div class="space-y-2 mt-1 px-1">
                                    <!-- 1. 필수 동의 -->
                                    <div class="flex items-start gap-2">
                                        <input type="checkbox" id="privacy-check" checked class="mt-1 accent-brand w-4 h-4 cursor-pointer">
                                        <label for="privacy-check" class="text-[11px] text-gray-500 leading-snug cursor-pointer">
                                            번호 입력 시 
                                            <a href="#" class="underline font-bold" onclick="event.stopPropagation(); alert('서비스 이용약관 팝업');">서비스 이용약관</a> 및 
                                            <a href="#" class="underline font-bold" onclick="event.stopPropagation(); alert('개인정보 처리방침 팝업');">개인정보 처리방침</a>에 
                                            동의한 것으로 간주합니다.
                                        </label>
                                    </div>
                                    <!-- 2. 마케팅 동의 (선택) -->
                                    <div class="flex items-start gap-2">
                                        <input type="checkbox" id="marketing-check" checked class="mt-0.5 accent-brand w-4 h-4 cursor-pointer">
                                        <label for="marketing-check" class="text-[11px] text-gray-500 leading-snug cursor-pointer">
                                            <span class="text-[#14682A] font-bold">[선택]</span> 이벤트 및 맞춤 특가 알림 수신에 동의합니다.
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </form>
    </div>

    <!-- [가상 카카오 인증창 (Simulated Kakao Window)] -->
    <div id="kakao-window-sim" class="fixed inset-0 bg-black/50 z-[100] flex items-end sm:items-center justify-center hidden opacity-0 transition-opacity duration-300">
        <div class="bg-white w-full max-w-[400px] rounded-t-3xl sm:rounded-2xl overflow-hidden shadow-2xl transform translate-y-full transition-transform duration-300" id="kakao-panel">
            <div class="p-4 border-b flex justify-between items-center bg-gray-50">
                <span class="font-bold text-sm text-gray-500">카카오 개인정보 동의</span>
                <button onclick="closeKakaoWindow()" class="p-2 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-8 text-center">
                <div class="w-16 h-16 bg-[#FEE500] rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-sm">
                    <i class="fas fa-comment text-3xl text-[#3c1e1e]"></i>
                </div>
                <h3 class="text-lg font-bold text-gray-800 mb-2">오더즈 싱크</h3>
                <p class="text-sm text-gray-500 leading-relaxed mb-8">
                    안전한 서비스 이용을 위해<br>카카오 정보를 전달합니다.<br>
                    <span class="text-[11px] text-gray-400">(마케팅 동의 포함)</span>
                </p>
                <button onclick="simulateKakaoSuccess()" class="w-full py-4 bg-[#FEE500] text-[#191919] rounded-xl font-bold text-base mb-3 shadow-sm">
                    동의하고 계속하기
                </button>
                <button onclick="closeKakaoWindow()" class="text-sm text-gray-400 font-medium py-2">
                    닫고 돌아가기
                </button>
            </div>
        </div>
    </div>

    <!-- [성공 팝업] -->
    <div id="toast-overlay" class="fixed inset-0 bg-black/60 z-[200] flex items-center justify-center hidden opacity-0 transition-opacity duration-300">
        <div class="bg-white rounded-xl p-6 w-[320px] text-center shadow-2xl transform scale-100 transition-transform relative">
            <div class="w-12 h-12 bg-green-50 text-green-500 rounded-full flex items-center justify-center mx-auto mb-4 text-xl"><i class="fas fa-check"></i></div>
            <h3 class="text-lg font-bold text-gray-800 mb-2">매칭이 완료되었습니다!</h3>
            <div class="text-sm text-gray-600 mb-5 leading-relaxed break-keep">사장님을 위한 특가 상품<br>페이지로 이동합니다.</div>
            <div class="w-full bg-gray-200 rounded-full h-1.5 overflow-hidden">
                <div class="bg-green-500 h-full w-0 transition-all duration-[1500ms] ease-out" id="progress-bar"></div>
            </div>
        </div>
    </div>

    <script>
        // 1. 주소 입력 로직
        function fillTestAddress() {
            const testAddr = "서울특별시 강남구 테헤란로 427";
            const addrInput = document.getElementById('mb_addr1');
            addrInput.value = testAddr;
            addrInput.classList.add('text-gray-900', 'font-medium');
            showAuthStep();
        }

        function openDaumPostcode() {
            if (typeof daum === 'undefined') { alert("주소 서비스 로딩 중..."); return; }
            new daum.Postcode({
                oncomplete: function(data) {
                    document.getElementById('mb_addr1').value = data.roadAddress;
                    document.getElementById('mb_addr1').classList.add('text-gray-900', 'font-medium');
                    showAuthStep();
                }
            }).open();
        }

        function showAuthStep() {
            const stepAuth = document.getElementById('step-auth');
            if (!stepAuth.classList.contains('show-step')) {
                stepAuth.classList.remove('hidden-step');
                stepAuth.classList.add('show-step');
                setTimeout(() => {
                    document.getElementById('mb_company').focus();
                    stepAuth.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 300);
            }
        }

        // 2. 카카오 인증창 시뮬레이션
        function handleKakaoSync() {
            const company = document.getElementById('mb_company').value.trim();
            if(!company) { alert("상호명을 입력해주세요."); document.getElementById('mb_company').focus(); return; }
            
            const overlay = document.getElementById('kakao-window-sim');
            const panel = document.getElementById('kakao-panel');
            overlay.classList.remove('hidden');
            setTimeout(() => {
                overlay.classList.remove('opacity-0');
                panel.classList.remove('translate-y-full');
            }, 10);
        }

        function closeKakaoWindow() {
            const overlay = document.getElementById('kakao-window-sim');
            const panel = document.getElementById('kakao-panel');
            panel.classList.add('translate-y-full');
            overlay.classList.add('opacity-0');
            
            setTimeout(() => {
                overlay.classList.add('hidden');
                // 창을 닫고 돌아온 시점에 리커버리 영역(휴대폰 입력) 노출
                showRecoveryArea();
            }, 300);
        }

        function showRecoveryArea() {
            const recoveryArea = document.getElementById('recovery-area');
            if (recoveryArea.classList.contains('hidden-step')) {
                recoveryArea.classList.remove('hidden-step');
                recoveryArea.classList.add('show-step');
                
                setTimeout(() => {
                    document.getElementById('mb_phone').focus();
                    recoveryArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 300);
            }
        }

        function simulateKakaoSuccess() {
            const overlay = document.getElementById('kakao-window-sim');
            overlay.classList.add('hidden');
            completeMatching();
        }

        // 3. 최종 완료 로직
        function submitWithPhone() {
            const phone = document.getElementById('mb_phone').value.trim();
            const consent = document.getElementById('privacy-check').checked;

            if(!phone || phone.length < 10) { alert("올바른 휴대폰 번호를 입력해주세요."); document.getElementById('mb_phone').focus(); return; }
            if(!consent) { alert("서비스 이용 약관에 동의해주셔야 특가 확인이 가능합니다."); return; }
            
            completeMatching();
        }

        function completeMatching() {
            const toast = document.getElementById('toast-overlay');
            const bar = document.getElementById('progress-bar');
            toast.classList.remove('hidden');
            setTimeout(() => toast.classList.remove('opacity-0'), 10);
            setTimeout(() => { bar.style.width = "100%"; }, 100);
            setTimeout(() => {
                const nextUrl = new URLSearchParams(window.location.search).get('next_url') || 'https://orderz.kr/shop/';
                alert(`매칭 완료! ${nextUrl}로 이동합니다.`);
                location.reload(); 
            }, 1800);
        }

        function autoHyphen(target) {
            target.value = target.value.replace(/[^0-9]/g, '').replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g, "$1-$2-$3").replace(/(\-{1,2})$/g, "");
        }
    </script>
</body>
</html>
